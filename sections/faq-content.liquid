{% schema %}
  {
    "name": "FAQ Category",
    "settings": [
      {
        "type": "text",
        "id": "category_1_title",
        "label": "Category 1 Title",
        "default": "ORDERS + SHIPPING"
      },
      {
        "type": "richtext",
        "id": "category_1_body",
        "label": "Category 1 Description",
        "default": "<p>Description for Category 1 FAQs.</p>"
      },
      {
        "type": "text",
        "id": "category_2_title",
        "label": "Category 2 Title",
        "default": "ORDERS + SHIPPING"
      },
      {
        "type": "richtext",
        "id": "category_2_body",
        "label": "Category 2 Description",
        "default": "<p>Description for Category 2 FAQs.</p>"
      },
      {
        "type": "text",
        "id": "category_3_title",
        "label": "Category 3 Title",
        "default": "ORDERS + SHIPPING"
      },
      {
        "type": "richtext",
        "id": "category_3_body",
        "label": "Category 3 Description",
        "default": "<p>Description for Category 3 FAQs.</p>"
      }
    ],
    "blocks": [
      {
        "type": "faq_category_1",
        "name": "FAQ - Category 1",
        "settings": [
          {
            "type": "text",
            "id": "question",
            "label": "Question",
            "default": "What is your question for Category 1?"
          },
          {
            "type": "richtext",
            "id": "answer",
            "label": "Answer",
            "default": "<p>Provide your answer for Category 1 here.</p>"
          }
        ]
      },
      {
        "type": "faq_category_2",
        "name": "FAQ - Category 2",
        "settings": [
          {
            "type": "text",
            "id": "question",
            "label": "Question",
            "default": "What is your question for Category 2?"
          },
          {
            "type": "richtext",
            "id": "answer",
            "label": "Answer",
            "default": "<p>Provide your answer for Category 2 here.</p>"
          }
        ]
      },
      {
        "type": "faq_category_3",
        "name": "FAQ - Category 3",
        "settings": [
          {
            "type": "text",
            "id": "question",
            "label": "Question",
            "default": "What is your question for Category 3?"
          },
          {
            "type": "richtext",
            "id": "answer",
            "label": "Answer",
            "default": "<p>Provide your answer for Category 3 here.</p>"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "FAQ Category",
        "category": "Content"
      }
    ]
  }
{% endschema %}


<div id="utility" class="utility-content md:mt-4 md:pt-[48px] py-[64px] md:pb-[48px] grid grid-cols-10 gap-x-3 lg:pl-1.5">
  {% for category in (1..3) %}
    {% assign category_title = 'category_' | append: category | append: '_title' %}
    {% assign category_type = 'faq_category_' | append: category %}

    {% if section.settings[category_title] != blank %}
      <!-- Category Title -->
      <div class="lg:col-start-2 lg:col-span-9 col-span-10 mt-8">
        <div class="faq-categories mb-6">
          <span class="faq-category underline-none">{{ section.settings[category_title] }}</span>
        </div>
      </div>

      <!-- Category FAQs -->
      <div class="md:col-start-2 md:col-span-9 col-span-10 lg:mb-8">
        <div class="faq-items" x-data="{ openSection: null }">
          {% for block in section.blocks %}
            {% if block.type == category_type %}
              <div id="{{ block.id }}" class="faq-item border-b border-current">
                <button 
                  @click="openSection = openSection === '{{ block.id }}' ? null : '{{ block.id }}'" 
                  class="faq-question body-sans w-full text-left flex items-center justify-between py-3"
                >
                  <span class="medium-serif">{{ block.settings.question }}</span>
                  <span
                    :class="{ 'rotate-180': openSection === '{{ block.id }}' }"
                    class="transition-transform duration-800 ease-in-out w-2 relative h-2 flex items-center justify-center"
                  >
                    <span class="w-full h-[1px] bg-current block"></span>
                    <span
                      :class="{ 'opacity-0': openSection === '{{ block.id }}' }"
                      class="h-full w-[1px] bg-current absolute block transition-opacity duration-800 ease-in-out"
                    ></span>
                  </span>
                </button>
                <div
                  class="h-0 overflow-hidden transition-all duration-800 ease-in-out"
                  x-ref="container-{{ block.id }}"
                  x-show="openSection === '{{ block.id }}'"
                  x-collapse.duration.800ms
                >
                  <div class="faq-answer medium-sans py-3">
                    {{ block.settings.answer }}
                  </div>
                </div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    {% endif %}
  {% endfor %}
</div>

<script>
  document.addEventListener('alpine:init', () => {
    Alpine.data('faqAccordion', () => ({
      openSection: null,
      toggle(id) {
        this.openSection = this.openSection === id ? null : id;
      }
    }));
  });
</script>