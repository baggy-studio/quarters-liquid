{% comment %}
  snippets/hours-and-info-fullscreen-overlay.liquid
{% endcomment %}

<template x-teleport="#contents">
  <div
    x-data="{ showCursor: true }"
    class="contents"
    :style="`--x: ${transformX}px; --y: ${transformY}px; --clip-path: ${clipPath}; --width: ${transformWidth}px; --height: ${transformHeight}px;`"
  >
    <div
      x-show="visible"
      @fullscreen:close.window="closeFullscreen"
      @keyup.escape.window="visible && closeFullscreen"
      x-ref="fullscreenFixed"
      data-fullscreen-fixed
      class="fixed inset-0 w-full h-full text-bone z-[9999] pointer-events-none opacity-0 duration-300 ease-linear transition-opacity lg:duration-0 lg:transition-none overflow-y-auto"
      :class="{
        'pointer-events-auto opacity-100': visible,
        'overflow-hidden': animating,
        'overflow-y-auto': !animating && visible
      }"
      style="min-height: 100vh; min-height: -webkit-fill-available;"
    >
      <div class="absolute top-0 left-0 w-full h-full bottom-0">
        <ul
          x-ref="fullscreen"
          data-fullscreen
          :data-count="media.length"
          class="w-full lg:origin-top-left relative h-full lg:will-change-[transform,width,height] lg:translate-x-[--x] lg:translate-y-[--y] lg:w-[--width] lg:h-[--height]"
          :style="`--x: ${transformX}px; --y: ${transformY}px; --width: ${transformWidth}px; --height: ${transformHeight}px;`"
        >
          <template x-for="(item, index) in media" :key="index">
            <li 
              x-show="selectedIndex === index" 
              class="contents"
              data-fullscreen-image
              :data-aspect-ratio="item.aspectRatio"
              :data-width="item.width"
              :data-height="item.height"
            >
              <img
                :src="item.src"
                :alt="item.alt"
                class="w-full h-full object-cover"
                sizes="100vw"
              >
            </li>
          </template>
        </ul>
        <button class="absolute left-0 inset-y-0 w-full lg:block hidden cursor-default" @click="closeFullscreen">
          <span class="sr-only">Close</span>
        </button>
        <button class="absolute left-0 inset-y-0 w-full lg:hidden block cursor-default" @click="nextImage">
          <span class="sr-only">Next image</span>
        </button>
      </div>
      <div class="fixed inset-0 w-full h-full lg:[will-change:clip-path] lg:[clip-path:var(--clip-path)] pointer-events-none" :style="`--clip-path: ${clipPath}`">
        <div class="absolute inset-0 min-h-screen px-4 w-full gap-3 lg:grid lg:grid-cols-20">
          <div class="w-full col-span-5 pb-4 pt-[120px] lg:pt-[calc(160px+152px+16px)] flex flex-col gap-8 lg:gap-0 justify-end min-h-screen">
            <div class="w-full relative flex flex-col gap-4">
              <div class="w-full relative flex flex-row items-baseline gap-4">
                <span class="large-accent" x-text="String(selectedIndex + 1).padStart(2, '0')"></span>
                <h2 class="large-serif" x-text="media[selectedIndex]?.caption"></h2>
              </div>
            </div>
          </div>
          {% render 'hours-and-info-fullscreen-cursor' %}
          {% render 'hours-and-info-fullscreen-thumbnail' %}
        </div>
      </div>
    </div>
  </div>
</template>